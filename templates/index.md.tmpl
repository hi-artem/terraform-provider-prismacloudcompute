---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "Prisma Cloud Compute Provider"
description: |-
  This is a community-driven fork of the official Prisma Cloud Compute provider with some extra sauce.
---

# Prisma Cloud Compute provider
This is a community-driven fork of the official Prisma Cloud Compute provider with some extra sauce.

## Example Usage
{{tffile "examples/provider/provider.tf"}}

## Simplifying Policies
Resources representing policies can become really long. It is often helpful to simplify their structure using HCL `dynamic` blocks.

```hcl
# First define your hosts variable
variable "hosts" {
  default = [
    { 
      name: "ec2-develop, 
      compliance_check: [
        { id: 16 }
      ]
    },
    { 
      name: "ec2-staging, 
      compliance_check: [
        { id: 16, block: true }
      ]
    },
    { 
      name: "ec2-staging, 
      compliance_check: [
        { id: 16, block: true },
        { id: 18, block: false }
      ]
    }
  ]
}

# And then use dynamic blocks to create a rule for each host
resource "prismacloudcompute_host_compliance_policy" "ruleset" {
  dynamic "rule" {

    for_each = var.hosts
    content {
      name        = "${rule.value.name}-compliance-policy"
      notes       = "Compliance policy for ${rule.value.name} host"
      collections = rule.value.collection_name

      disabled           = false
      effect             = "alert"
      show_passed_checks = true
      verbose            = true

      dynamic "compliance_check" {
        for_each = rule.value.compliance_checks
        content {
          id    = compliance_check.value.id
          block = try(compliance_check.value.block, false)
        }
      }
    }
  }
}
```
